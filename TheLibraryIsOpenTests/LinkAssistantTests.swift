import XCTest
@testable import TheLibraryIsOpen

class LinkAssistantTests: XCTestCase {

    func test_getIdFrom_whenURLIsRegularApplePodcastsURL_andIDHas9Digits_shouldReturnPodcastID() throws {
        let testURL = "https://podcasts.apple.com/br/podcast/um-milkshake-chamado-wanda/id916378162"
        let expectedID = 916378162
        XCTAssertEqual(try LinkAssistant.getIdFrom(url: testURL), expectedID)
    }
    
    func test_getIdFrom_whenURLIsRegularApplePodcastsURL_andIDHas10Digits_shouldReturnPodcastID() throws {
        let testURL = "https://podcasts.apple.com/br/podcast/praia-dos-ossos/id1528797207"
        let expectedID = 1528797207
        XCTAssertEqual(try LinkAssistant.getIdFrom(url: testURL), expectedID)
    }
    
    // With ? at the end
    /*func test_getIdFrom_whenURLIsApplePodcastsURLWithAdditionalInfoAtTheEnd_shouldReturnPodcastID() throws {
        let testURL = "https://podcasts.apple.com/br/podcast/um-milkshake-chamado-wanda/id916378162?"
        let expectedID = 916378162
        XCTAssertEqual(try LinkAssistant.getIdFrom(url: testURL), expectedID)
    }*/
    
    func test_getIdFrom_whenURLIsSpotifyURL_shouldThrowException() throws {
        let testURL = "https://open.spotify.com/show/05mXtsHUlelamU3w0nGJ8a?si=3cf4a99f2cf14f39"

        XCTAssertThrowsError(try LinkAssistant.getIdFrom(url: testURL)) { error in
            XCTAssertEqual(error as! LinkAssistantError, LinkAssistantError.spotifyLink)
        }
    }
    
    /*func test_getIdFrom_whenURLIsPocketCastsURL_shouldReturnPodcastID() throws {
        let testURL = "https://pca.st/62wamcsk"
        let expectedID = 617416468
        XCTAssertEqual(try LinkAssistant.getIdFrom(url: testURL), expectedID)
    }*/

}
